@page
@model TrackItWeb.Pages.Fitness.Log.UpdateLogModel
@{
	ViewData["Title"] = "update log.";
	@Html.AntiForgeryToken()
}

<style>
	.form-check-input:checked {
		background-color: #000;
		border-color: #000;
	}

	.select2-container--default .select2-selection--single,
	.select2-selection .select2-selection--single {
		border: 1px solid #d2d6de;
		border-radius: 0;
		padding: 6px 12px;
		height: 28px
	}

	.select2-container--default .select2-selection--single {
		background-color: #fff;
		border: 1px solid #aaa;
		border-radius: 0px
	}

	.select2-container .select2-selection--single {
		box-sizing: border-box;
		cursor: pointer;
		display: block;
		height: 28px;
		user-select: none;
		-webkit-user-select: none
	}

		.select2-container .select2-selection--single .select2-selection__rendered {
			padding-right: 10px
		}

		.select2-container .select2-selection--single .select2-selection__rendered {
			padding-left: 0px;
			padding-right: 20px;
			height: auto;
			font-weight: bold;
			margin-top: -8px
		}

	.select2-container--default .select2-selection--single .select2-selection__rendered {
		color: #444;
		line-height: 28px
	}

	.select2-container--default .select2-selection--single,
	.select2-selection .select2-selection--single {
		border: 2px solid #d2d6de;
		border-radius: 0 !important;
		padding: 6px 12px;
		height: 28px !important
	}

		.select2-container--default .select2-selection--single .select2-selection__arrow {
			height: 26px;
			position: absolute;
			top: 0px !important;
			right: 1px;
			width: 20px
		}

	.select2-hidden-accessible {
		border: 0 !important;
		clip: rect(0 0 0 0) !important;
		height: 1px !important;
		margin: -5px !important;
		overflow: hidden !important;
		padding: 0 !important;
		position: absolute !important;
		width: 1px !important
	}
</style>

<nav aria-label="breadcrumb">
	<ol class="breadcrumb">
		<li class="breadcrumb-item" aria-current="page"><a class="text-decoration-none text-dark" href="/Fitness/Index">fitness</a></li>
		<li class="breadcrumb-item" aria-current="page"><a class="text-decoration-none text-dark" href="/Fitness/Log/Logs">logs</a></li>
		<li class="breadcrumb-item active" aria-current="page">update log</li>
	</ol>
</nav>
<form method="post">
	<div class="row">
		<input id="MemberWorkoutID" type="hidden" asp-for="@Model.MyResult.MemberWorkoutID" />
		<input id="MemberID" type="hidden" asp-for="@Model.MyResult.MemberID" />
		<input id="MemberID" type="hidden" asp-for="@Model.MyResult.GUID" />
		<input id="MemberID" type="hidden" asp-for="@Model.MyResult.CreatedDate" />
		<div class="col-6 col-xl-6">
			<label class="form-label text-dark float-start fw-bold">workout name.</label>
			<input type="text" class="form-control form-control-md border-2 rounded-0 bg-transparent text-dark fw-bold" asp-for="@Model.MyResult.MemberWorkoutName" required />
		</div>
		<div class="col-3 col-xl-2 mt-2">
			<div class="row">
				<div class="col-xl-12">
					<label class="form-label text-dark float-start fw-bold">created date.</label><br>
				</div>
				<div class="col-xl-12">
					<p class=" text-dark float-start fw-bold mt-1">@Model.MyResult.CreatedDate.ToShortDateString()</p>
				</div>
			</div>
		</div>
		<div class="col-3 col-xl-2 mt-2">
			<div class="row">
				<div class="col-xl-12">
					<label class="form-label text-dark float-start fw-bold">updated date.</label><br>
				</div>
				<div class="col-xl-12">
					<p class=" text-dark float-start fw-bold mt-1"> @Model.MyResult.UpdatedDate.ToShortDateString()</p>
				</div>
			</div>
		</div>
		<div class="col-12 mt-3">
			<label class="form-label text-dark float-start fw-bold" for="typeEmailX">notes.</label>
			<textarea type="text" class="form-control form-control-md border-2 rounded-0 bg-transparent text-dark fw-bold" asp-for="@Model.MyResult.Notes">@Model.MyResult.Notes</textarea>
		</div>
		<div class="col-12" style="margin-top: 23px; margin-right:520px">
			<div class="form-check form-switch">
				<label class="form-label text-dark fw-bold">is done?</label>
				<input class="form-check-input" type="checkbox" id="flexSwitchCheckDefault" asp-for="@Model.MyResult.isDone">
			</div>
		</div>
	</div>
	<div class="mt-3 d-flex justify-content-center">
		<button class="btn btn-dark btn-md rounded-0 float-end" id="submit" type="submit" asp-page-handler="Update">Update.</button>
	</div>
</form>

<div class="row mt-5 p-1">
	<div class="col-3">
		<div class="row">
			<div class="col-12">
				<label class="form-label text-dark float-start fw-bold" for="ddl">your wrkts.</label>
			</div>
			<div class="col-12">
				<select id="ddl_your" class="form-control-md border border-2 rounded-0 bg-transparent text-dark fw-bold" style="width: 98px; height: 27px;" asp-items="Model.YourWorkouts" required>
					<option value="0">Choose Our Workout</option>
				</select>
			</div>
		</div>
	</div>
	<div class="col-3">
		<div class="row">
			<div class="col-12">
				<label class="form-label text-dark float-start fw-bold" for="ddl">our wrkts.</label>
			</div>
			<div class="col-12">
				<select id="ddl_our" class="form-control-md border border-2 rounded-0 bg-transparent text-dark fw-bold" style="width: 98px; height: 27px;" asp-items="Model.OurWorkouts" required>
					<option value="0">Choose Your Workout</option>
				</select>
			</div>
		</div>
	</div>
	<div class="col-2">
		<div class="row">
			<div class="col-12">
				<label class="form-label text-dark float-start fw-bold" for="ddl">reps.</label>
			</div>
			<div class="col-12">
				<input id="reps" min="0" value="0" type="number" class="form-control border-2 rounded-0 bg-transparent text-dark fw-bold" style="width: 70px; height: 27px;" required />
			</div>
		</div>
	</div>
	<div class="col-2">
		<div class="row">
			<div class="col-12">
				<label class="form-label text-dark float-start fw-bold" for="ddl">weight.</label>
			</div>
			<div class="col-12">
				<input id="weight" min="0" value="0" type="number" class="form-control border-2 rounded-0 bg-transparent text-dark fw-bold" style="width: 70px; height: 27px;" />
			</div>
		</div>
	</div>
	<div class="col-2">
		<div class="row">
			<div class="col-12">
				<label class="form-label text-light float-end fw-bold" for="ddl">.</label>
			</div>
			<div class="col-12">
				<button id="btn_sbmt" class="btn btn-outline-dark border-1 btn-sm rounded-0 fw-bold float-end" style="width:30px" onclick="PostStats()">+</button>
			</div>
		</div>
	</div>
</div>

<p id="warning" class="fw-bold text-center text-danger mt-2" hidden>please select workout.</p>
<div class="mt-5 p-1 hidden" id="LogStats"></div>

<script>
	$(document).ready(function () {
		$('#ddl_our').select2();
		$('#ddl_your').select2();
	});


	$("#ddl_our").change(function () {
		if ($(this).val() > 0) { $("#ddl_your").prop("disabled", true); $("#warning").attr("hidden", true); }
		else { $("#ddl_your").prop("disabled", false) }
	});
	$("#ddl_your").change(function () {
		if ($(this).val() > 0) { $("#ddl_our").prop("disabled", true); $("#warning").attr("hidden", true); }
		else { $("#ddl_our").prop("disabled", false); }
	});

	$(document).ready(function () {
		LoadStats();
	});

	function LoadStats() {
		var id = $("#MemberWorkoutID").val();

		$.ajax(
			{
				type: "GET",
				url: "?handler=LoadLogStats",
				data: { id: id },
				headers:
				{
					"RequestVerificationToken": $('input:hidden[name="__RequestVerificationToken"]').val()
				},
				success:
					function (response) {
						if (response != "") {
							$("#LogStats").html(response);
						}
					},
				error:
					function (response) {
						alert("Error: " + response);
					}
			});
	}

	function PostStats() {
		var formData = new FormData();

		var id = $("#MemberWorkoutID").val();
		var memberId = $("#MemberID").val();
		var our = $("#ddl_our").val();
		var your = $("#ddl_your").val();
		var reps = $("#reps").val();
		var weight = $("#weight").val();

		var itemID = 0;
		var tableName = "";

		if (our > 0) { itemID = our; tableName = "Workout" }
		if (your > 0) { itemID = your; tableName = "MemberWorkout" }

		formData.append('model.MemberWorkoutLogID', id);
		formData.append('model.MemberID', memberId);
		formData.append('model.ItemID', itemID);
		formData.append('model.TableName', tableName);
		formData.append('model.Reps', reps);
		formData.append('model.Weight', weight);

		if (itemID > 0) {
			$.ajax(
				{
					type: "POST",
					url: "?handler=AddLogStats",
					contentType: false,
					processData: false,
					data: formData,
					headers:
					{
						"RequestVerificationToken": $('input[name="__RequestVerificationToken"]').val(),
					},
					success:
						function (response) {
							if (response == "success")
								LoadStats();
						},
					error:
						function (response) {
							alert("Error: " + response);
						}
				});
		}
		else {
			$("#warning").attr("hidden", false);
		}
	}

	function DeleteStat(id) {
		$.ajax(
			{
				type: "POST",
				url: "?handler=DeleteStat",
				data: { id: id },
				headers:
				{
					"RequestVerificationToken": $('input[name="__RequestVerificationToken"]').val(),
				},
				success:
					function (response) {
						if (response == "success")
							LoadStats();
					},
				error:
					function (response) {
						alert("Error: " + response);
					}
			});
	}

	function preventBack() { window.history.forward(); }
	setTimeout("preventBack()", 0);
	window.onunload = function () { null };
</script>
